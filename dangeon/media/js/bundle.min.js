"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a};!function(a){function c(d){if(b[d])return b[d].exports;var e=b[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,c),e.loaded=!0,e.exports}var b={};return c.m=a,c.c=b,c.p="",c(0)}([function(a,b,c){var d=c(1),e=c(3),f=c(4),g=c(5);window.onload=function(){function b(){function I(){var a=!1;d.contain(n,{x:32,y:16,width:b.width-32,height:b.height-32}),n.x+=n.vx,n.y+=n.vy,x.forEach(function(c){c.x+=c.vx,c.y+=c.vy;var e=d.contain(c,{x:32,y:16,width:b.width-32,height:b.height-32});("top"==e||"bottom"==e)&&(c.vy*=-1),g.hitTestRectangle(n,c)&&(a=!0)}),g.hitTestRectangle(n,p)&&(n.hasTreasure=!0,p.x=n.x+8,p.y=n.y+8,n.layer=1),a?(n.alpha=.5,H.inner.width-=3):n.alpha=1,g.hitTestRectangle(n,o)&&n.hasTreasure&&(q.visible=!1,E.visible=!0,C.layer=2,C.content="u wOn"),H.inner.width<=0&&(q.visible=!1,E.visible=!0,E.layer=1,C.layer=2,C.content="Wasted")}function J(){requestAnimationFrame(J),I(),e.render(b)}var b=e.makeCanvas(510,510);document.getElementById("output");e.stage.width=b.width,e.stage.height=b.height;var h=f.makePointer(b),i=f.keyboard(38);i.press=function(){n.vy=-1},i.release=function(){n.vy=0};var j=f.keyboard(37);j.press=function(){n.vx=-1},j.release=function(){n.vx=0};var k=f.keyboard(40);k.press=function(){n.vy=1},k.release=function(){n.vy=0};var l=f.keyboard(39);l.press=function(){n.vx=1},l.release=function(){n.vx=0},console.log(h);var m=e.sprite(d.assets["dungeon.png"]),n=e.sprite(d.assets["explorer.png"]);n.hasTreasure=!1,e.stage.putCenter(n,-128);var o=e.sprite(d.assets["door.png"]);o.x=32;var p=e.sprite(d.assets["treasure.png"]);e.stage.putRight(p,-64);for(var q=e.group(m,o,n,p),r=6,s=48,t=150,u=1,v=3,w=1,x=[],y=0;r>y;y++){var z=e.sprite(d.assets["blob.png"]),A=s*y+t,B=d.randomInt(0,b.height-z.height);z.x=A,z.y=B,z.vy=d.randomInt(u,v)*w,w*=-1,x.push(z),q.addChild(z)}var C=e.text("Game Over!","30px puzzler","white",20,20);C.x=120,C.y=b.height/2-64,console.log(C.parent);var D=e.sprite(d.assets[a+"giphy.gif"]);D.width=b.width,D.height=b.height;var E=e.group(C,D);E.visible=!1;var F=e.rectangle(100,10,"black"),G=e.rectangle(100,10,"red"),H=e.group(F,G);H.inner=G,H.x=b.width-120,H.y=4,J()}var a="media/img/";d.assets.load([a+"treasureHunter.json",a+"giphy.gif","media/fonts/puzzler.otf"]).then(b)}},function(a,b,c){function f(a,b){var c=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2],d=b.x,e=b.y,f=b.width,g=b.height,h=void 0;return a.x<d-a.width&&(h="left"),a.y<e-a.height&&(h="top"),a.x>f&&(h="right"),a.y>g&&(h="bottom"),h&&c&&c(h),h}function g(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],e=b.x,f=b.y,g=b.width,h=b.height,i=void 0;return a.x<e&&(c&&(a.vx*=-1),a.mass&&(a.vx/=a.mass),a.x=e,i="left"),a.y<f&&(c&&(a.vy*=-1),a.mass&&(a.vy/=a.mass),a.y=f,i="top"),a.x+a.width>g&&(c&&(a.vx*=-1),a.mass&&(a.vx/=a.mass),a.x=g-a.width,i="right"),a.y+a.height>h&&(c&&(a.vy*=-1),a.mass&&(a.vy/=a.mass),a.y=h-a.height,i="bottom"),i&&d&&d(i),i}function h(a,b){var c=b.centerX-a.centerX,d=b.centerY-a.centerY;return Math.sqrt(c*c+d*d)}function i(a,b,c){var d=b.centerX-a.centerX,e=b.centerY-a.centerY,f=Math.sqrt(d*d+e*e);f>=1&&(a.x+=d*c,a.y+=e*c)}function k(a,b,c){var d=b.centerX-a.centerX,e=b.centerY-a.centerY,f=Math.sqrt(d*d+e*e);f>=c&&(a.x+=d/f*c,a.y+=e/f*c)}function m(a,b,c,d){a.x=b.centerX-a.parent.x+c*Math.cos(d)-a.halfWidth,a.y=b.centerY-a.parent.y+c*Math.sin(d)-a.halfWidth}function n(a,b,c,d,e){var f={};return f.x=a+Math.cos(e)*c,f.y=b+Math.sin(e)*d,f}function q(a,b,c,d,e,f){var g=f();g.x=a.centerX-g.halfWidth+c*Math.cos(b),g.y=a.centerY-g.halfHeight+c*Math.sin(b),g.vx=Math.cos(b)*d,g.vy=Math.sin(b)*d,e.push(g)}function r(){var a=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return new Promise(function(b,c){setTimeout(b,a)})}function s(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];if(1===b.length){var d=b[0];d.x+=d.vx,d.y+=d.vy}else for(var e=0;e<b.length;e++){var f=b[e];f.x+=f.vx,f.y+=f.vy}}Object.defineProperty(b,"__esModule",{value:!0}),b.fade=b.slide=b.randomFloat=b.randomInt=b.angle=b.easeProperty=b.assets=void 0,b.outsideBounds=f,b.contain=g,b.distance=h,b.followEase=i,b.followConstant=k,b.rotateSprite=m,b.rotatePoint=n,b.shoot=q,b.wait=r,b.move=s;var d=c(2);b.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif"],fontExtensions:["ttf","otf","ttc","woff"],jsonExtensions:["json"],audioExtensions:["mp3","ogg","wav","webm"],load:function(a){var b=this;return new Promise(function(c){var d=function(){b.loaded+=1,console.log(b.loaded),b.toLoad===b.loaded&&(b.toLoad=0,b.loaded=0,console.log("Assets finished loading"),c())};console.log("Loading assets..."),b.toLoad=a.length,a.forEach(function(a){var c=a.split(".").pop();-1!==b.imageExtensions.indexOf(c)?b.loadImage(a,d):-1!==b.fontExtensions.indexOf(c)?b.loadFont(a,d):-1!==b.jsonExtensions.indexOf(c)?b.loadJson(a,d):-1!==b.audioExtensions.indexOf(c)?b.loadSound(a,d):console.log("File type not recognized: "+a)})})},loadImage:function(a,b){var c=new Image;c.addEventListener("load",b,!1),this[a]=c,c.src=a},loadFont:function(a,b){var c=a.split("/").pop().split(".")[0],d=document.createElement("style"),e="@font-face {font-family: '"+c+"'; src: url('"+a+"');}";d.appendChild(document.createTextNode(e)),document.head.appendChild(d),b()},loadJson:function(a,b){var c=this,d=new XMLHttpRequest;d.open("GET",a,!0),d.responseType="text",d.onload=function(e){if(200===d.status){var f=JSON.parse(d.responseText);f.name=a,c[f.name]=f,f.frames?c.createTilesetFrames(f,a,b):b()}},d.send()},createTilesetFrames:function(a,b,c){var d=this,e=b.replace(/[^\/]*$/,""),f=e+a.meta.image,g=function(){d[f]=h,Object.keys(a.frames).forEach(function(b){d[b]=a.frames[b],d[b].source=h}),c()},h=new Image;h.addEventListener("load",g,!1),h.src=f},loadSound:function(a,b){var c=d.makeSound(a,b);c.name=a,this[c.name]=c}},b.easeProperty=function(a,b,c){var d=b-a;return d>=1?d*c:0},b.angle=function(a,b){return Math.atan2(b.centerY-a.centerY,b.centerX-a.centerX)},b.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},b.randomFloat=function(a,b){return a+Math.random()*(b-a)},b.slide=function(a,b,c,d){var e=new TWEEN.Tween({x:a.x,y:a.y}).to({x:b,y:c},d);return e.easing(TWEEN.Easing.Circular.Out),e.onUpdate(function(){a.x=this.x,a.y=this.y}),e.start(),e},b.fade=function(a,b,c){var d=new TWEEN.Tween({alpha:a.alpha}).to({alpha:b},c);d.easing(TWEEN.Easing.Linear.None),d.onUpdate(function(){a.alpha=this.alpha}),d.start()}},function(a,b){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){return new f(a,b)}function h(a){function u(a){var b=e.createConvolver();b.buffer=i(o[0],o[1],o[2]),a.connect(b),b.connect(r)}function v(a){var b=e.createGain(),c=e.createDelay(),d=e.createBiquadFilter();c.delayTime.value=n[0],b.gain.value=n[1],n[2]&&(d.frequency.value=n[2]),c.connect(b),n[2]?(b.connect(d),d.connect(c)):b.connect(c),a.connect(c),c.connect(r)}function w(a){a.gain.value=0,a.gain.linearRampToValueAtTime(0,e.currentTime+h),a.gain.linearRampToValueAtTime(f,e.currentTime+h+b)}function x(a){a.gain.linearRampToValueAtTime(f,e.currentTime+b+h),a.gain.linearRampToValueAtTime(0,e.currentTime+h+b+c)}function y(a){var d=a.frequency.value;k?(a.frequency.linearRampToValueAtTime(d,e.currentTime+h),a.frequency.linearRampToValueAtTime(d+j,e.currentTime+h+b+c)):(a.frequency.linearRampToValueAtTime(d,e.currentTime+h),a.frequency.linearRampToValueAtTime(d-j,e.currentTime+h+b+c))}function z(){var a=e.createOscillator(),d=e.createOscillator(),g=e.createGain(),h=e.createGain();g.gain.value=f,h.gain.value=f,a.connect(g),g.connect(e.destination),d.connect(h),h.connect(e.destination),a.type="sawtooth",d.type="sawtooth",a.frequency.value=s+m,d.frequency.value=s-m,b>0&&(w(g),w(h)),c>0&&(x(g),x(h)),j>0&&(y(a),y(d)),n&&(v(g),v(h)),o&&(u(g),u(h)),A(a),A(d)}function A(a){a.start(e.currentTime+h)}var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?1:arguments[2],d=arguments.length<=3||void 0===arguments[3]?"sine":arguments[3],f=arguments.length<=4||void 0===arguments[4]?1:arguments[4],g=arguments.length<=5||void 0===arguments[5]?0:arguments[5],h=arguments.length<=6||void 0===arguments[6]?0:arguments[6],j=arguments.length<=7||void 0===arguments[7]?0:arguments[7],k=arguments.length<=8||void 0===arguments[8]?!1:arguments[8],l=arguments.length<=9||void 0===arguments[9]?0:arguments[9],m=arguments.length<=10||void 0===arguments[10]?0:arguments[10],n=arguments.length<=11||void 0===arguments[11]?void 0:arguments[11],o=arguments.length<=12||void 0===arguments[12]?void 0:arguments[12],p=e.createOscillator(),q=e.createGain(),r=e.createStereoPanner();p.connect(q),q.connect(r),r.connect(e.destination),q.gain.value=f,r.pan.value=g,p.type=d;var s=void 0,t=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};s=l>0?t(a-l/2,a+l/2):a,p.frequency.value=s,b>0&&w(q),c>0&&x(q),j>0&&y(p),n&&v(q),o&&u(q),m>0&&z(),A(p)}function i(){for(var a=arguments.length<=0||void 0===arguments[0]?2:arguments[0],b=arguments.length<=1||void 0===arguments[1]?2:arguments[1],c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=e.sampleRate*a,f=e.createBuffer(2,d,e.sampleRate),g=f.getChannelData(0),h=f.getChannelData(1),i=0;d>i;i++){var j=void 0;j=c?d-i:i,g[i]=(2*Math.random()-1)*Math.pow(1-j/d,b),h[i]=(2*Math.random()-1)*Math.pow(1-j/d,b)}return f}Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.makeSound=g,b.soundEffect=h;var e=new AudioContext,f=function(){function a(b,c){d(this,a),this.source=b,this.loadHandler=c,this.actx=e,this.volumeNode=this.actx.createGain(),this.panNode=this.actx.createStereoPanner(),this.convolverNode=this.actx.createConvolver(),this.delayNode=this.actx.createDelay(),this.feedbackNode=this.actx.createGain(),this.filterNode=this.actx.createBiquadFilter(),this.soundNode=null,this.buffer=null,this.loop=!1,this.playing=!1,this.panValue=0,this.volumeValue=1,this.startTime=0,this.startOffset=0,this.playbackRate=1,this.randomPitch=!0,this.reverb=!1,this.reverbImpulse=null,this.echo=!1,this.delayValue=.3,this.feebackValue=.3,this.filterValue=0,this.load()}return c(a,[{key:"load",value:function(){var a=this,b=new XMLHttpRequest;b.open("GET",this.source,!0),b.responseType="arraybuffer",b.addEventListener("load",function(){a.actx.decodeAudioData(b.response,function(b){a.buffer=b,a.hasLoaded=!0,a.loadHandler&&a.loadHandler()},function(a){throw new Error("Audio could not be decoded: "+a)})}),b.send()}},{key:"play",value:function(){this.startTime=this.actx.currentTime,this.soundNode=this.actx.createBufferSource(),this.soundNode.buffer=this.buffer,this.soundNode.connect(this.volumeNode),this.reverb===!1?this.volumeNode.connect(this.panNode):(this.volumeNode.connect(this.convolverNode),this.convolverNode.connect(this.panNode),this.convolverNode.buffer=this.reverbImpulse),this.panNode.connect(this.actx.destination),this.echo&&(this.feedbackNode.gain.value=this.feebackValue,this.delayNode.delayTime.value=this.delayValue,this.filterNode.frequency.value=this.filterValue,this.delayNode.connect(this.feedbackNode),this.filterValue>0?(this.feedbackNode.connect(this.filterNode),this.filterNode.connect(this.delayNode)):this.feedbackNode.connect(this.delayNode),this.volumeNode.connect(this.delayNode),this.delayNode.connect(this.panNode)),this.soundNode.loop=this.loop,this.soundNode.playbackRate.value=this.playbackRate,this.soundNode.start(this.startTime,this.startOffset%this.buffer.duration),this.playing=!0}},{key:"setReverb",value:function(){var a=arguments.length<=0||void 0===arguments[0]?2:arguments[0],b=arguments.length<=1||void 0===arguments[1]?2:arguments[1],c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.reverbImpulse=i(a,b,c),this.reverb=!0}},{key:"setEcho",value:function(){var a=arguments.length<=0||void 0===arguments[0]?.3:arguments[0],b=arguments.length<=1||void 0===arguments[1]?.3:arguments[1],c=arguments.length<=2||void 0===arguments[2]?0:arguments[2];this.delayValue=a,this.feebackValue=b,this.filterValue=c,this.echo=!0}},{key:"pause",value:function(){this.playing&&(this.soundNode.stop(this.actx.currentTime),this.startOffset+=this.actx.currentTime-this.startTime,this.playing=!1,console.log(this.startOffset))}},{key:"restart",value:function(){this.playing&&this.soundNode.stop(this.actx.currentTime),this.startOffset=0,this.startPoint=0,this.endPoint=this.buffer.duration,this.play()}},{key:"playFrom",value:function(a){this.playing&&this.soundNode.stop(this.actx.currentTime),this.startOffset=a,this.play()}},{key:"playSection",value:function(a,b){this.playing&&this.soundNode.stop(this.actx.currentTime),0===this.startOffset&&(this.startOffset=a),this.startTime=this.actx.currentTime,this.soundNode=this.actx.createBufferSource(),this.soundNode.buffer=this.buffer,this.soundNode.connect(this.panNode),this.panNode.connect(this.volumeNode),this.volumeNode.connect(this.actx.destination),this.soundNode.loop=this.loop,this.soundNode.loopStart=a,this.soundNode.loopEnd=b;var c=b-a;this.soundNode.start(this.startTime,this.startOffset%this.buffer.duration,c),this.playing=!0}},{key:"volume",get:function(){return this.volumeValue},set:function(a){this.volumeNode.gain.value=a,this.volumeValue=a}},{key:"pan",get:function(){return this.panNode.pan.value},set:function(a){this.panNode.pan.value=a}}]),a}()},function(a,b){function d(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==("undefined"==typeof b?"undefined":_typeof(b))&&"function"!=typeof b?a:b}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":_typeof(b)));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(){var a=arguments.length<=0||void 0===arguments[0]?256:arguments[0],b=arguments.length<=1||void 0===arguments[1]?256:arguments[1],c=arguments.length<=2||void 0===arguments[2]?"1px dashed black":arguments[2],d=arguments.length<=3||void 0===arguments[3]?"white":arguments[3],e=document.createElement("canvas");return e.width=a,e.height=b,e.style.border=c,e.style.backgroundColor=d,document.body.appendChild(e),e.ctx=e.getContext("2d"),e}function k(a,b,c,d,e,f,g){var i=new j(a,b,c,d,e,f,g);return h.addChild(i),i}function m(a,b,c,d,e,f){var g=new l(a,b,c,d,e,f);return h.addChild(g),g}function o(a,b,c,d,e,f){var g=new n(a,b,c,d,e,f);return h.addChild(g),g}function q(a,b,c,d,e){var f=new p(a,b,c,d,e);return h.addChild(f),f}function s(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];var d=new(Function.prototype.bind.apply(r,[null].concat(b)));return h.addChild(d),d}function u(a,b,c){var d=new t(a,b,c);return d.frames.length>0&&J(d),h.addChild(d),d}function v(a,b,c,d,e){var f={};return f.image=a,f.x=b,f.y=c,f.width=d,f.height=e,f}function w(a,b,c,d){var e={};return e.image=a,e.data=b,e.width=c,e.height=d,e}function y(a,b,c){var d=new x(a,b,c);return h.addChild(d),d}function z(){var a=arguments.length<=0||void 0===arguments[0]?0:arguments[0],b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?32:arguments[2],d=arguments.length<=3||void 0===arguments[3]?32:arguments[3],e=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],f=arguments.length<=5||void 0===arguments[5]?0:arguments[5],g=arguments.length<=6||void 0===arguments[6]?0:arguments[6],h=arguments.length<=7||void 0===arguments[7]?void 0:arguments[7],i=arguments.length<=8||void 0===arguments[8]?void 0:arguments[8],j=s(),k=function(){for(var k=a*b,l=0;k>l;l++){var m=l%a*c,n=Math.floor(l/a)*d,o=h();j.addChild(o),e?(o.x=m+c/2-o.halfWidth+f,o.y=n+d/2-o.halfHeight+g):(o.x=m+f,o.y=n+g),i&&i(o)}};return k(),j}function A(a,b,c){for(var d=arguments.length<=3||void 0===arguments[3]?0:arguments[3],e=[],f=a.width/b,g=a.height/c,h=f*g,i=0;h>i;i++){var j=i%f*b,k=Math.floor(i/f)*c;d&&d>0&&(j+=d+d*i%f,k+=d+d*Math.floor(i/f)),e.push([j,k])}return w(a,e,b,c)}function B(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];b.forEach(function(a){a.parent.removeChild(a)})}function C(a,b){return a.layer<b.layer?-1:(a.layer>b.layer,1)}function E(a){a.press=a.press||void 0,a.release=a.release||void 0,a.over=a.over||void 0,a.out=a.out||void 0,a.tap=a.tap||void 0,a.state="up",a.action="",a.pressed=!1,a.hoverOver=!1,a.update=function(b,c){var d=b.hitTestSprite(a);b.isUp&&(a.state="up",a instanceof x&&a.gotoAndStop(0)),d&&(a.state="over",a.frames&&3===a.frames.length&&a instanceof x&&a.gotoAndStop(1),b.isDown&&(a.state="down",a instanceof x&&(3===a.frames.length?a.gotoAndStop(2):a.gotoAndStop(1)))),"down"===a.state&&(a.pressed||(a.press&&a.press(),a.pressed=!0,a.action="pressed")),"over"===a.state&&(a.pressed&&(a.release&&a.release(),a.pressed=!1,a.action="released",b.tapped&&a.tap&&a.tap()),a.hoverOver||(a.over&&a.over(),a.hoverOver=!0)),"up"===a.state&&(a.pressed&&(a.release&&a.release(),a.pressed=!1,a.action="released"),a.hoverOver&&(a.out&&a.out(),a.hoverOver=!1))}}function G(a,b){var c=null,d=0,e=0;if(a.isDown)if(null===c)for(var f=F.length-1;f>-1;f--){var g=F[f];if(a.hitTestSprite(g)&&g.draggable){d=a.x-g.gx,e=a.y-g.gy,c=g;var h=g.parent.children;h.splice(h.indexOf(g),1),h.push(g);break}}else c.x=a.x-d,c.y=a.y-e;a.isUp&&(c=null),F.some(function(c){return a.hitTestSprite(c)&&c.draggable?(b.style.cursor="pointer",!0):(b.style.cursor="auto",!1)})}function H(a){function c(d){d.visible&&d.gx<a.width+d.width&&d.gx+d.width>=-d.width&&d.gy<a.height+d.height&&d.gy+d.height>=-d.height&&(b.save(),b.translate(d.x+d.width*d.pivotX,d.y+d.height*d.pivotY),b.rotate(d.rotation),b.globalAlpha=d.alpha*d.parent.alpha,b.scale(d.scaleX,d.scaleY),d.shadow&&(b.shadowColor=d.shadowColor,b.shadowOffsetX=d.shadowOffsetX,b.shadowOffsetY=d.shadowOffsetY,b.shadowBlur=d.shadowBlur),d.blendMode&&(b.globalCompositeOperation=d.blendMode),d.render&&d.render(b),d.children&&d.children.length>0&&(b.translate(-d.width*d.pivotX,-d.height*d.pivotY),d.children.forEach(function(a){c(a)})),b.restore())}var b=a.ctx;b.clearRect(0,0,a.width,a.height),h.children.forEach(function(a){c(a)})}function I(a,b){function d(e){e.visible&&e.gx<a.width+e.width&&e.gx+e.width>-e.width&&e.gy<a.height+e.height&&e.gy+e.height>-e.height&&(c.save(),void 0!==e.previousX?e.renderX=(e.x-e.previousX)*b+e.previousX:e.renderX=e.x,void 0!==e.previousY?e.renderY=(e.y-e.previousY)*b+e.previousY:e.renderY=e.y,c.translate(e.renderX+e.width*e.pivotX,e.renderY+e.height*e.pivotY),c.rotate(e.rotation),c.globalAlpha=e.alpha*e.parent.alpha,c.scale(e.scaleX,e.scaleY),e.shadow&&(c.shadowColor=e.shadowColor,c.shadowOffsetX=e.shadowOffsetX,c.shadowOffsetY=e.shadowOffsetY,c.shadowBlur=e.shadowBlur),e.blendMode&&(c.globalCompositeOperation=e.blendMode),e.render&&e.render(c),e.children&&e.children.length>0&&(c.translate(-e.width*e.pivotX,-e.height*e.pivotY),e.children.forEach(function(a){d(a)})),c.restore())}var c=a.ctx;c.clearRect(0,0,a.width,a.height),h.children.forEach(function(a){d(a)})}function J(a){function g(b){l(),a.gotoAndStop(b)}function h(){a.playing||j([0,a.frames.length-1])}function i(){a.playing&&(l(),a.gotoAndStop(a.currentFrame))}function j(g){l(),d=g[0],e=g[1],c=e-d,0===d&&(c+=1,b+=1),1===c&&(c=2,b+=1),a.fps||(a.fps=12);var h=1e3/a.fps;a.gotoAndStop(d),a.playing||(f=setInterval(k.bind(this),h),a.playing=!0)}function k(){c>b?(a.gotoAndStop(a.currentFrame+1),b+=1):a.loop&&(a.gotoAndStop(d),b=1)}function l(){void 0!==f&&a.playing===!0&&(a.playing=!1,b=0,d=0,e=0,c=0,clearInterval(f))}var b=0,c=0,d=0,e=0,f=void 0;a.show=g,a.play=h,a.stop=i,a.playSequence=j}function L(a,b){function e(){c.playing||(b(),d=setInterval(g.bind(this),a),c.playing=!0)}function f(){c.playing&&(clearInterval(d),c.playing=!1)}function g(){b()}var c={},d=void 0;return c.playing=!1,c.play=e,c.stop=f,c}function M(){function z(d){var f=c();f.frames.length>0&&f.gotoAndStop(u(0,f.frames.length-1)),f.x=a-f.halfWidth,f.y=b-f.halfHeight;var g=u(i,j);f.width=g,f.height=g,f.scaleSpeed=t(n,o),f.alphaSpeed=t(p,q),f.rotationSpeed=t(r,s);var h=t(k,l);f.vx=h*Math.cos(d),f.vy=h*Math.sin(d),f.update=function(){f.vy+=e,f.x+=f.vx,f.y+=f.vy,f.scaleX-f.scaleSpeed>0&&(f.scaleX-=f.scaleSpeed),f.scaleY-f.scaleSpeed>0&&(f.scaleY-=f.scaleSpeed),f.rotation+=f.rotationSpeed,f.alpha-=f.alphaSpeed,f.alpha<=0&&(B(f),K.splice(K.indexOf(f),1))},K.push(f)}for(var a=arguments.length<=0||void 0===arguments[0]?0:arguments[0],b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?function(){return m(10,"red")}:arguments[2],d=arguments.length<=3||void 0===arguments[3]?10:arguments[3],e=arguments.length<=4||void 0===arguments[4]?0:arguments[4],f=arguments.length<=5||void 0===arguments[5]?!0:arguments[5],g=arguments.length<=6||void 0===arguments[6]?0:arguments[6],h=arguments.length<=7||void 0===arguments[7]?6.28:arguments[7],i=arguments.length<=8||void 0===arguments[8]?4:arguments[8],j=arguments.length<=9||void 0===arguments[9]?16:arguments[9],k=arguments.length<=10||void 0===arguments[10]?.1:arguments[10],l=arguments.length<=11||void 0===arguments[11]?1:arguments[11],n=arguments.length<=12||void 0===arguments[12]?.01:arguments[12],o=arguments.length<=13||void 0===arguments[13]?.05:arguments[13],p=arguments.length<=14||void 0===arguments[14]?.02:arguments[14],q=arguments.length<=15||void 0===arguments[15]?.02:arguments[15],r=arguments.length<=16||void 0===arguments[16]?.01:arguments[16],s=arguments.length<=17||void 0===arguments[17]?.03:arguments[17],t=function(a,b){return a+Math.random()*(b-a)},u=function(a,b){return Math.floor(Math.random()*(b-a+1))+a},v=[],w=void 0,x=(h-g)/(d-1),y=0;d>y;y++)f?(w=t(g,h),v.push(w)):(void 0===w&&(w=g),v.push(w),w+=x);v.forEach(function(a){return z(a)})}function N(a,b,c){var d=arguments.length<=3||void 0===arguments[3]?0:arguments[3],e=arguments.length<=4||void 0===arguments[4]?0:arguments[4],f=void 0,g=void 0;c.frame?(f=c.frame.w,g=c.frame.h):(f=c.width,g=c.height);var h=void 0,i=void 0;h=a>=f?Math.round(a/f)+1:2,i=b>=g?Math.round(b/g)+1:2;var j=z(h,i,f,g,!1,0,0,function(){var a=u(c);return a});j._tileX=0,j._tileY=0;var l=k(a,b,"none","none");return l.x=d,l.y=e,l.mask=!0,l.addChild(j),Object.defineProperties(l,{tileX:{get:function(){return j._tileX},set:function(a){j.children.forEach(function(b){var c=a-j._tileX;b.x+=c,b.x>(h-1)*f&&(b.x=0-f+c),b.x<0-f-c&&(b.x=(h-1)*f)}),j._tileX=a},enumerable:!0,configurable:!0},tileY:{get:function(){return j._tileY},set:function(a){j.children.forEach(function(b){var c=a-j._tileY;b.y+=c,b.y>(i-1)*g&&(b.y=0-g+c),b.y<0-g-c&&(b.y=(i-1)*g)}),j._tileY=a},enumerable:!0,configurable:!0}}),l}function P(a){function k(){e>d&&(a.x=f,a.y=g,b-=i,a.x+=j(-b,b),a.y+=j(-b,b),d+=1),d>=e&&(a.x=f,a.y=g,O.splice(O.indexOf(a),1))}function m(){e>d&&(a.rotation=h,b-=i,a.rotation=b*l,d+=1,l*=-1),d>=e&&(a.rotation=h,O.splice(O.indexOf(a),1))}var b=arguments.length<=1||void 0===arguments[1]?16:arguments[1],c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=1,e=10,f=a.x,g=a.y,h=a.rotation,i=b/e,j=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};-1===O.indexOf(a)&&(O.push(a),a.updateShake=function(){c?m():k()});var l=1}Object.defineProperty(b,"__esModule",{value:!0});var c=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();b.makeCanvas=i,b.rectangle=k,b.circle=m,b.line=o,b.text=q,b.group=s,b.sprite=u,b.frame=v,b.frames=w,b.button=y,b.grid=z,b.filmstrip=A,b.byLayer=C,b.updateDragAndDrop=G,b.render=H,b.renderWithInterpolation=I,b.emitter=L,b.particleEffect=M,b.tilingSprite=N,b.shake=P;var g=function(){function a(){f(this,a),this.x=0,this.y=0,this.width=0,this.height=0,this.rotation=0,this.alpha=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this.pivotX=.5,this.pivotY=.5,this.vx=0,this.vy=0,this._layer=0,this.children=[],this.parent=void 0,this.shadow=!1,this.shadowColor="rgba(100, 100, 100, 0.5)",this.shadowOffsetX=3,this.shadowOffsetY=3,this.shadowBlur=3,this.blendMode=void 0,this.frames=[],this.loop=!0,this._currentFrame=0,this.playing=!1,this._draggable=void 0,this._circular=!1,this._interactive=!1,this.previousX=0,this.previousY=0}return c(a,[{key:"addChild",value:function(a){a.parent&&a.parent.removeChild(a),a.parent=this,this.children.push(a)}},{key:"removeChild",value:function(a){if(a.parent!==this)throw new Error(a+"is not a child of "+this);this.children.splice(this.children.indexOf(a),1)}},{key:"setPosition",value:function(a,b){this.x=a,this.y=b}},{key:"putCenter",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?0:arguments[2],d=this;a.x=d.x+d.halfWidth-a.halfWidth+b,a.y=d.y+d.halfHeight-a.halfHeight+c}},{key:"putTop",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?0:arguments[2],d=this;a.x=d.x+d.halfWidth-a.halfWidth+b,a.y=d.y-a.height+c}},{key:"putRight",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?0:arguments[2],d=this;a.x=d.x+d.width+b,a.y=d.y+d.halfHeight-a.halfHeight+c}},{key:"putBottom",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?0:arguments[2],d=this;a.x=d.x+d.halfWidth-a.halfWidth+b,a.y=d.y+d.height+c}},{key:"putLeft",value:function(a){var b=arguments.length<=1||void 0===arguments[1]?0:arguments[1],c=arguments.length<=2||void 0===arguments[2]?0:arguments[2],d=this;a.x=d.x-a.width+b,a.y=d.y+d.halfHeight-a.halfHeight+c}},{key:"swapChildren",value:function(a,b){var c=this.children.indexOf(a),d=this.children.indexOf(b);if(-1===c||-1===d)throw new Error("Both objects must be a child of the caller "+this);a.childIndex=d,b.childIndex=c,this.children[c]=b,this.children[d]=a}},{key:"add",value:function(){for(var a=this,b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];c.forEach(function(b){return a.addChild(b)})}},{key:"remove",value:function(){for(var a=this,b=arguments.length,c=Array(b),d=0;b>d;d++)c[d]=arguments[d];c.forEach(function(b){return a.removeChild(b)})}},{key:"gx",get:function(){return this.parent?this.x+this.parent.gx:this.x}},{key:"gy",get:function(){return this.parent?this.y+this.parent.gy:this.y}},{key:"layer",get:function(){return this._layer},set:function(a){this._layer=a,this.parent&&this.parent.children.sort(function(a,b){return a.layer-b.layer})}},{key:"halfWidth",get:function(){return this.width/2}},{key:"halfHeight",get:function(){return this.height/2}},{key:"centerX",get:function(){return this.x+this.halfWidth}},{key:"centerY",get:function(){return this.y+this.halfHeight}},{key:"position",get:function(){return{x:this.x,y:this.y}}},{key:"localBounds",get:function(){return{x:0,y:0,width:this.width,height:this.height}}},{key:"globalBounds",get:function(){return{x:this.gx,y:this.gy,width:this.gx+this.width,height:this.gy+this.height}}},{key:"empty",get:function(){return 0===this.children.length?!0:!1}},{key:"currentFrame",get:function(){return this._currentFrame}},{key:"circular",get:function(){return this._circular},set:function(a){a===!0&&this._circular===!1&&(Object.defineProperties(this,{diameter:{get:function(){return this.width},set:function(a){this.width=a,this.height=a},enumerable:!0,configurable:!0},radius:{get:function(){return this.halfWidth},set:function(a){this.width=2*a,this.height=2*a},enumerable:!0,configurable:!0}}),this._circular=!0),a===!1&&this._circular===!0&&(delete this.diameter,delete this.radius,this._circular=!1)}},{key:"draggable",get:function(){return this._draggable},set:function(a){a===!0&&(F.push(this),this._draggable=!0),a===!1&&F.splice(F.indexOf(this),1)}},{key:"interactive",get:function(){return this._interactive},set:function(a){a===!0&&(E(this),D.push(this),this._interactive=!0),a===!1&&(D.splice(D.indexOf(this),1),this._interactive=!1)}}]),a}(),h=b.stage=new g,j=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?32:arguments[0],c=arguments.length<=1||void 0===arguments[1]?32:arguments[1],e=arguments.length<=2||void 0===arguments[2]?"gray":arguments[2],g=arguments.length<=3||void 0===arguments[3]?"none":arguments[3],h=arguments.length<=4||void 0===arguments[4]?0:arguments[4],i=arguments.length<=5||void 0===arguments[5]?0:arguments[5],j=arguments.length<=6||void 0===arguments[6]?0:arguments[6];f(this,b);var k=d(this,Object.getPrototypeOf(b).call(this));return Object.assign(k,{width:a,height:c,fillStyle:e,strokeStyle:g,lineWidth:h,x:i,y:j}),k.mask=!1,k}return e(b,a),c(b,[{key:"render",value:function(a){a.strokeStyle=this.strokeStyle,a.lineWidth=this.lineWidth,a.fillStyle=this.fillStyle,a.beginPath(),a.rect(-this.width*this.pivotX,-this.height*this.pivotY,this.width,this.height),"none"!==this.strokeStyle&&a.stroke(),"none"!==this.fillStyle&&a.fill(),this.mask&&this.mask===!0&&a.clip()}}]),b}(g),l=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?32:arguments[0],c=arguments.length<=1||void 0===arguments[1]?"gray":arguments[1],e=arguments.length<=2||void 0===arguments[2]?"none":arguments[2],g=arguments.length<=3||void 0===arguments[3]?0:arguments[3],h=arguments.length<=4||void 0===arguments[4]?0:arguments[4],i=arguments.length<=5||void 0===arguments[5]?0:arguments[5];f(this,b);var j=d(this,Object.getPrototypeOf(b).call(this));return j.circular=!0,Object.assign(j,{diameter:a,fillStyle:c,strokeStyle:e,lineWidth:g,x:h,y:i}),j.mask=!1,j}return e(b,a),c(b,[{key:"render",value:function(a){a.strokeStyle=this.strokeStyle,a.lineWidth=this.lineWidth,a.fillStyle=this.fillStyle,a.beginPath(),a.arc(this.radius+-this.diameter*this.pivotX,this.radius+-this.diameter*this.pivotY,this.radius,0,2*Math.PI,!1),"none"!==this.strokeStyle&&a.stroke(),"none"!==this.fillStyle&&a.fill(),this.mask&&this.mask===!0&&a.clip()}}]),b}(g),n=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?"none":arguments[0],c=arguments.length<=1||void 0===arguments[1]?0:arguments[1],e=arguments.length<=2||void 0===arguments[2]?0:arguments[2],g=arguments.length<=3||void 0===arguments[3]?0:arguments[3],h=arguments.length<=4||void 0===arguments[4]?32:arguments[4],i=arguments.length<=5||void 0===arguments[5]?32:arguments[5];f(this,b);var j=d(this,Object.getPrototypeOf(b).call(this));return Object.assign(j,{strokeStyle:a,lineWidth:c,ax:e,ay:g,bx:h,by:i}),j.lineJoin="round",j}return e(b,a),c(b,[{key:"render",value:function(a){a.strokeStyle=this.strokeStyle,a.lineWidth=this.lineWidth,a.lineJoin=this.lineJoin,a.beginPath(),a.moveTo(this.ax,this.ay),a.lineTo(this.bx,this.by),"none"!==this.strokeStyle&&a.stroke()}}]),b}(g),p=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?"Hello!":arguments[0],c=arguments.length<=1||void 0===arguments[1]?"12px sans-serif":arguments[1],e=arguments.length<=2||void 0===arguments[2]?"red":arguments[2],g=arguments.length<=3||void 0===arguments[3]?0:arguments[3],h=arguments.length<=4||void 0===arguments[4]?0:arguments[4];f(this,b);var i=d(this,Object.getPrototypeOf(b).call(this));return Object.assign(i,{content:a,font:c,fillStyle:e,x:g,y:h}),i.textBaseline="top",
i.strokeText="none",i}return e(b,a),c(b,[{key:"render",value:function(a){a.font=this.font,a.strokeStyle=this.strokeStyle,a.lineWidth=this.lineWidth,a.fillStyle=this.fillStyle,0===this.width&&(this.width=a.measureText(this.content).width),0===this.height&&(this.height=a.measureText("M").width),a.translate(-this.width*this.pivotX,-this.height*this.pivotY),a.textBaseline=this.textBaseline,a.fillText(this.content,0,0),"none"!==this.strokeText&&a.strokeText()}}]),b}(g),r=function(a){function b(){f(this,b);for(var a=d(this,Object.getPrototypeOf(b).call(this)),c=arguments.length,e=Array(c),g=0;c>g;g++)e[g]=arguments[g];return e.forEach(function(b){return a.addChild(b)}),a}return e(b,a),c(b,[{key:"addChild",value:function(a){a.parent&&a.parent.removeChild(a),a.parent=this,this.children.push(a),this.calculateSize()}},{key:"removeChild",value:function(a){if(a.parent!==this)throw new Error(a+" is not a child of "+this);this.children.splice(this.children.indexOf(a),1),this.calculateSize()}},{key:"calculateSize",value:function(){var a=this;this.children.length>0&&(this._newWidth=0,this._newHeight=0,this.children.forEach(function(b){b.x+b.width>a._newWidth&&(a._newWidth=b.x+b.width),b.y+b.height>a._newHeight&&(a._newHeight=b.y+b.height)}),this.width=this._newWidth,this.height=this._newHeight)}}]),b}(g),t=function(a){function b(a){var c=arguments.length<=1||void 0===arguments[1]?0:arguments[1],e=arguments.length<=2||void 0===arguments[2]?0:arguments[2];f(this,b);var g=d(this,Object.getPrototypeOf(b).call(this));if(Object.assign(g,{x:c,y:e}),a instanceof Image)g.createFromImage(a);else if(a.frame)g.createFromAtlas(a);else if(a.image&&!a.data)g.createFromTileset(a);else if(a.image&&a.data)g.createFromTilesetFrames(a);else{if(!(a instanceof Array))throw new Error("The image source "+a+" is not recognized");if(a[0]&&a[0].source)g.createFromAtlasFrames(a);else{if(!(a[0]instanceof Image))throw new Error("The image sources in "+a+" are not recognized");g.createFromImages(a)}}return g}return e(b,a),c(b,[{key:"createFromImage",value:function(a){if(!(a instanceof Image))throw new Error(a+" is not an image object");this.source=a,this.sourceX=0,this.sourceY=0,this.width=a.width,this.height=a.height,this.sourceWidth=a.width,this.sourceHeight=a.height}},{key:"createFromAtlas",value:function(a){this.tilesetFrame=a,this.source=this.tilesetFrame.source,this.sourceX=this.tilesetFrame.frame.x,this.sourceY=this.tilesetFrame.frame.y,this.width=this.tilesetFrame.frame.w,this.height=this.tilesetFrame.frame.h,this.sourceWidth=this.tilesetFrame.frame.w,this.sourceHeight=this.tilesetFrame.frame.h}},{key:"createFromTileset",value:function(a){if(!(a.image instanceof Image))throw new Error(a.image+" is not an image object");this.source=a.image,this.sourceX=a.x,this.sourceY=a.y,this.width=a.width,this.height=a.height,this.sourceWidth=a.width,this.sourceHeight=a.height}},{key:"createFromTilesetFrames",value:function(a){if(!(a.image instanceof Image))throw new Error(a.image+" is not an image object");this.source=a.image,this.frames=a.data,this.sourceX=this.frames[0][0],this.sourceY=this.frames[0][1],this.width=a.width,this.height=a.height,this.sourceWidth=a.width,this.sourceHeight=a.height}},{key:"createFromAtlasFrames",value:function(a){this.frames=a,this.source=a[0].source,this.sourceX=a[0].frame.x,this.sourceY=a[0].frame.y,this.width=a[0].frame.w,this.height=a[0].frame.h,this.sourceWidth=a[0].frame.w,this.sourceHeight=a[0].frame.h}},{key:"createFromImages",value:function(a){this.frames=a,this.source=a[0],this.sourceX=0,this.sourceY=0,this.width=a[0].width,this.height=a[0].width,this.sourceWidth=a[0].width,this.sourceHeight=a[0].height}},{key:"gotoAndStop",value:function(a){if(!(this.frames.length>0&&a<this.frames.length))throw new Error("Frame number "+a+" does not exist");this.frames[0]instanceof Array?(this.sourceX=this.frames[a][0],this.sourceY=this.frames[a][1]):this.frames[a].frame?(this.sourceX=this.frames[a].frame.x,this.sourceY=this.frames[a].frame.y,this.sourceWidth=this.frames[a].frame.w,this.sourceHeight=this.frames[a].frame.h,this.width=this.frames[a].frame.w,this.height=this.frames[a].frame.h):(this.source=this.frames[a],this.sourceX=0,this.sourceY=0,this.width=this.source.width,this.height=this.source.height,this.sourceWidth=this.source.width,this.sourceHeight=this.source.height),this._currentFrame=a}},{key:"render",value:function(a){a.drawImage(this.source,this.sourceX,this.sourceY,this.sourceWidth,this.sourceHeight,-this.width*this.pivotX,-this.height*this.pivotY,this.width,this.height)}}]),b}(g),x=function(a){function b(a){var c=arguments.length<=1||void 0===arguments[1]?0:arguments[1],e=arguments.length<=2||void 0===arguments[2]?0:arguments[2];f(this,b);var g=d(this,Object.getPrototypeOf(b).call(this,a,c,e));return g.interactive=!0,g}return e(b,a),b}(t);b.remove=B;var D=b.buttons=[],F=b.draggableSprites=[],K=b.particles=[],O=b.shakingSprites=[];b.progressBar={maxWidth:0,height:0,backgroundColor:"gray",foregroundColor:"cyan",backBar:null,frontBar:null,percentage:null,assets:null,initialized:!1,create:function(a,b){this.initialized||(this.assets=b,this.maxWidth=a.width/2,this.backBar=k(this.maxWidth,32,this.backgroundColor),this.backBar.x=a.width/2-this.maxWidth/2,this.backBar.y=a.height/2-16,this.frontBar=k(this.maxWidth,32,this.foregroundColor),this.frontBar.x=a.width/2-this.maxWidth/2,this.frontBar.y=a.height/2-16,this.percentage=q("0%","28px sans-serif","black"),this.percentage.x=a.width/2-this.maxWidth/2+12,this.percentage.y=a.height/2-16,this.initialized=!0)},update:function(){var a=(this.assets.loaded+1)/this.assets.toLoad;this.frontBar.width=this.maxWidth*a,this.percentage.content=Math.floor(100*a)+" %"},remove:function(){B(this.frontBar),B(this.backBar),B(this.percentage)}}},function(a,b){function c(a){var b=arguments.length<=1||void 0===arguments[1]?1:arguments[1],c={element:a,scale:b,_x:0,_y:0,get x(){return this._x/this.scale},get y(){return this._y/this.scale},get centerX(){return this.x},get centerY(){return this.y},get position(){return{x:this.x,y:this.y}},isDown:!1,isUp:!0,tapped:!1,downTime:0,elapsedTime:0,press:void 0,release:void 0,tap:void 0,dragSprite:null,dragOffsetX:0,dragOffsetY:0,moveHandler:function(a){var b=a.target;this._x=a.pageX-b.offsetLeft,this._y=a.pageY-b.offsetTop,a.preventDefault()},touchmoveHandler:function(a){var b=a.target;this._x=a.targetTouches[0].pageX-b.offsetLeft,this._y=a.targetTouches[0].pageY-b.offsetTop,a.preventDefault()},downHandler:function(a){this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),a.preventDefault()},touchstartHandler:function(a){var b=a.target;this._x=a.targetTouches[0].pageX-b.offsetLeft,this._y=a.targetTouches[0].pageY-b.offsetTop,this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),a.preventDefault()},upHandler:function(a){this.elapsedTime=Math.abs(this.downTime-Date.now()),this.elapsedTime<=200&&this.tapped===!1&&(this.tapped=!0,this.tap&&this.tap()),this.isUp=!0,this.isDown=!1,this.release&&this.release(),a.preventDefault()},touchendHandler:function(a){this.elapsedTime=Math.abs(this.downTime-Date.now()),this.elapsedTime<=200&&this.tapped===!1&&(this.tapped=!0,this.tap&&this.tap()),this.isUp=!0,this.isDown=!1,this.release&&this.release(),a.preventDefault()},hitTestSprite:function(a){var b=!1;if(a.circular){var g=this.x-(a.gx+a.radius),h=this.y-(a.gy+a.radius),i=Math.sqrt(g*g+h*h);b=i<a.radius}else{var c=a.gx,d=a.gx+a.width,e=a.gy,f=a.gy+a.height;b=this.x>c&&this.x<d&&this.y>e&&this.y<f}return b},updateDragAndDrop:function(a){var b=this;if(this.isDown)if(null===this.dragSprite)for(var c=a.length-1;c>-1;c--){var d=a[c];if(this.hitTestSprite(d)&&d.draggable){this.dragOffsetX=this.x-d.gx,this.dragOffsetY=this.y-d.gy,this.dragSprite=d;var e=d.parent.children;e.splice(e.indexOf(d),1),e.push(d),a.splice(a.indexOf(d),1),a.push(d);break}}else this.dragSprite.x=this.x-this.dragOffsetX,this.dragSprite.y=this.y-this.dragOffsetY;this.isUp&&(this.dragSprite=null),a.some(function(a){return b.hitTestSprite(a)&&a.draggable?(b.element.style.cursor="pointer",!0):(b.element.style.cursor="auto",!1)})}};return a.addEventListener("mousemove",c.moveHandler.bind(c),!1),a.addEventListener("mousedown",c.downHandler.bind(c),!1),window.addEventListener("mouseup",c.upHandler.bind(c),!1),a.addEventListener("touchmove",c.touchmoveHandler.bind(c),!1),a.addEventListener("touchstart",c.touchstartHandler.bind(c),!1),window.addEventListener("touchend",c.touchendHandler.bind(c),!1),a.style.touchAction="none",c}function d(a){var b={};return b.code=a,b.isDown=!1,b.isUp=!0,b.press=void 0,b.release=void 0,b.downHandler=function(a){a.keyCode===b.code&&(b.isUp&&b.press&&b.press(),b.isDown=!0,b.isUp=!1),a.preventDefault()},b.upHandler=function(a){a.keyCode===b.code&&(b.isDown&&b.release&&b.release(),b.isDown=!1,b.isUp=!0),a.preventDefault()},window.addEventListener("keydown",b.downHandler.bind(b),!1),window.addEventListener("keyup",b.upHandler.bind(b),!1),b}Object.defineProperty(b,"__esModule",{value:!0}),b.makePointer=c,b.keyboard=d},function(a,b){function c(a,b){var c=void 0,d=void 0,e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0;return c=b.radius?"circle":"rectangle","rectangle"===c&&(d=b.x,e=b.x+b.width,f=b.y,g=b.y+b.height,k=a.x>d&&a.x<e&&a.y>f&&a.y<g),"circle"===c&&(h=a.x-b.centerX,i=a.y-b.centerY,j=Math.sqrt(h*h+i*i),k=j<b.radius),k}function d(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;return c?(d=b.gx+b.radius-(a.gx+a.radius),e=b.gy+b.radius-(a.gy+a.radius)):(d=b.centerX-a.centerX,e=b.centerY-a.centerY),f=Math.sqrt(d*d+e*e),g=a.radius+b.radius,h=g>f}function e(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l={},m=!1;if(d?(h=b.gx+b.radius-(a.gx+a.radius),i=b.gy+b.radius-(a.gy+a.radius)):(h=b.centerX-a.centerX,i=b.centerY-a.centerY),e=Math.sqrt(h*h+i*i),f=a.radius+b.radius,f>e){m=!0,g=f-e;var o=.3;g+=o,j=h/e,k=i/e,a.x-=g*j,a.y-=g*k,c&&(l.x=i,l.y=-h,n(a,l))}return m}function f(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=void 0,e=void 0,f=void 0,g=void 0,h={},i={},j={},k={},l={},m=!1;if(a.mass=a.mass||1,b.mass=b.mass||1,c?(h.vx=b.gx+b.radius-(a.gx+a.radius),h.vy=b.gy+b.radius-(a.gy+a.radius)):(h.vx=b.centerX-a.centerX,h.vy=b.centerY-a.centerY),h.magnitude=Math.sqrt(h.vx*h.vx+h.vy*h.vy),d=a.radius+b.radius,h.magnitude<d){m=!0,e=d-h.magnitude,e+=.3,h.dx=h.vx/h.magnitude,h.dy=h.vy/h.magnitude,h.vxHalf=Math.abs(h.dx*e/2),h.vyHalf=Math.abs(h.dy*e/2),f=a.x>b.x?1:-1,g=a.y>b.y?1:-1,a.x=a.x+h.vxHalf*f,a.y=a.y+h.vyHalf*g,b.x=b.x+h.vxHalf*-f,b.y=b.y+h.vyHalf*-g,h.lx=h.vy,h.ly=-h.vx;var n=a.vx*h.dx+a.vy*h.dy;i.x=n*h.dx,i.y=n*h.dy;var o=a.vx*(h.lx/h.magnitude)+a.vy*(h.ly/h.magnitude);j.x=o*(h.lx/h.magnitude),j.y=o*(h.ly/h.magnitude);var p=b.vx*h.dx+b.vy*h.dy;k.x=p*h.dx,k.y=p*h.dy;var q=b.vx*(h.lx/h.magnitude)+b.vy*(h.ly/h.magnitude);l.x=q*(h.lx/h.magnitude),l.y=q*(h.ly/h.magnitude),a.bounce={},a.bounce.x=j.x+k.x,a.bounce.y=j.y+k.y,b.bounce={},b.bounce.x=i.x+l.x,b.bounce.y=i.y+l.y,a.vx=a.bounce.x/a.mass,a.vy=a.bounce.y/a.mass,b.vx=b.bounce.x/b.mass,b.vy=b.bounce.y/b.mass}return m}function g(a){for(var b=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],c=0;c<a.length;c++)for(var d=a[c],e=c+1;e<a.length;e++){var g=a[e];f(d,g,b)}}function h(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=void 0,e=void 0,f=void 0,g=void 0,h=void 0;return d=!1,c?(g=a.gx+a.halfWidth-(b.gx+b.halfWidth),h=a.gy+a.halfHeight-(b.gy+b.halfHeight)):(g=a.centerX-b.centerX,h=a.centerY-b.centerY),e=a.halfWidth+b.halfWidth,f=a.halfHeight+b.halfHeight,d=Math.abs(g)<e&&Math.abs(h)<f?!0:!1}function i(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=arguments.length<=3||void 0===arguments[3]?!0:arguments[3],e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0;return d?(j=a.gx+a.halfWidth-(b.gx+b.halfWidth),k=a.gy+a.halfHeight-(b.gy+b.halfHeight)):(j=a.centerX-b.centerX,k=a.centerY-b.centerY),f=a.halfWidth+b.halfWidth,g=a.halfHeight+b.halfHeight,Math.abs(j)<f&&Math.abs(k)<g&&(h=f-Math.abs(j),i=g-Math.abs(k),h>=i?(k>0?(e="top",a.y=a.y+i):(e="bottom",a.y=a.y-i),c&&(a.vy*=-1)):(j>0?(e="left",a.x=a.x+h):(e="right",a.x=a.x-h),c&&(a.vx*=-1))),e}function j(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=void 0,e=void 0,f=void 0,g=void 0,i=void 0,j=void 0;if(c?(f=a.gx,g=a.gy,i=b.gx,j=b.gy):(f=a.x,g=a.y,i=b.x,j=b.y),d=g<j-b.halfHeight?f<i-1-b.halfWidth?"topLeft":f>i+1+b.halfWidth?"topRight":"topMiddle":g>j+b.halfHeight?f<i-1-b.halfWidth?"bottomLeft":f>i+1+b.halfWidth?"bottomRight":"bottomMiddle":f<i-b.halfWidth?"leftMiddle":"rightMiddle","topMiddle"===d||"bottomMiddle"===d||"leftMiddle"===d||"rightMiddle"===d)e=h(a,b,c);else{var l={};switch(d){case"topLeft":l.x=i,l.y=j;break;case"topRight":l.x=i+b.width,l.y=j;break;case"bottomLeft":l.x=i,l.y=j+b.height;break;case"bottomRight":l.x=i+b.width,l.y=j+b.height}e=k(a,l,c)}return e?d:e}function k(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return b.diameter=1,b.radius=.5,b.centerX=b.x,b.centerY=b.y,b.gx=b.x,b.gy=b.y,d(a,b,c)}function l(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],e=void 0,f=void 0,g=void 0,h=void 0,j=void 0,k=void 0;if(d?(g=a.gx,h=a.gy,j=b.gx,k=b.gy):(g=a.x,h=a.y,j=b.x,k=b.y),e=h<k-b.halfHeight?g<j-1-b.halfWidth?"topLeft":g>j+1+b.halfWidth?"topRight":"topMiddle":h>k+b.halfHeight?g<j-1-b.halfWidth?"bottomLeft":g>j+1+b.halfWidth?"bottomRight":"bottomMiddle":g<j-b.halfWidth?"leftMiddle":"rightMiddle","topMiddle"===e||"bottomMiddle"===e||"leftMiddle"===e||"rightMiddle"===e)f=i(a,b,c,d);else{var l={};switch(e){case"topLeft":l.x=j,l.y=k;break;case"topRight":l.x=j+b.width,l.y=k;break;case"bottomLeft":l.x=j,l.y=k+b.height;break;case"bottomRight":l.x=j+b.width,l.y=k+b.height}f=m(a,l,c,d)}return f?e:f}function m(a,b){var c=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],d=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];return b.diameter=1,b.radius=.5,b.centerX=b.x,b.centerY=b.y,b.gx=b.x,b.gy=b.y,e(a,b,c,d)}function n(a,b){var c=void 0,d=void 0,e={},f={},g={},h=a.mass||1;b.lx=b.y,b.ly=-b.x,b.magnitude=Math.sqrt(b.x*b.x+b.y*b.y),b.dx=b.x/b.magnitude,b.dy=b.y/b.magnitude,c=a.vx*b.dx+a.vy*b.dy,e.vx=c*b.dx,e.vy=c*b.dy,d=a.vx*(b.lx/b.magnitude)+a.vy*(b.ly/b.magnitude),f.vx=d*(b.lx/b.magnitude),f.vy=d*(b.ly/b.magnitude),f.vx*=-1,f.vy*=-1,g.x=e.vx+f.vx,g.y=e.vy+f.vy,a.vx=g.x/h,a.vy=g.y/h}function o(a,b){function r(a,b){var d=void 0!==a.parent,e=void 0!==b.parent;if(d&&e)return a.diameter&&b.diameter?t(a,b):a.diameter&&!b.diameter?v(a,b):u(a,b);if(e&&void 0!==a.x&&void 0!==a.y)return c(a,b);throw new Error("I'm sorry, "+a+" and "+b+" cannot be use together in a collision test.'")}function s(){if(a instanceof Array)var c=[e,d],d=c[0],e=c[1];for(var f=b.length-1;f>=0;f--){var g=b[f];o=r(a,g),o&&n&&n(o,g)}}function t(a,b){return g?a.vx+a.vy!==0&&b.vx+b.vy!==0?f(a,b,m):e(a,b,k,m):d(a,b)}function u(a,b){return g?i(a,b,k,m):h(a,b,m)}function v(a,b){return g?l(a,b,k,m):j(a,b,m)}var g=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],k=arguments.length<=3||void 0===arguments[3]?!1:arguments[3],m=arguments[4],n=arguments.length<=5||void 0===arguments[5]?void 0:arguments[5],o=void 0,p=void 0!==a.parent,q=void 0!==b.parent;return p&&b instanceof Array||q&&a instanceof Array?s():(o=r(a,b),o&&n&&n(o)),o}Object.defineProperty(b,"__esModule",{value:!0}),b.hitTestPoint=c,b.hitTestCircle=d,b.circleCollision=e,b.movingCircleCollision=f,b.multipleCircleCollision=g,b.hitTestRectangle=h,b.rectangleCollision=i,b.hitTestCircleRectangle=j,b.hitTestCirclePoint=k,b.circleRectangleCollision=l,b.circlePointCollision=m,b.hit=o}]);